grid=: dyad : 'x (<<.-:2$y)} (2$y)$0'

gd=: grid&5

R=:(,-)(,:|.)0 1
I=:+[:(_4&*+[:+/R|.!.0])3&<
S=:I^:_

s=:(+[:(_4&*+[:+/((,-)(,:|.)0 1)|.!.0])3&<)^:_
s gd 100
